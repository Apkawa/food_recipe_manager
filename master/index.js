(()=>{"use strict";var e={236:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ready=void 0,t.ready=function(e){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e()}},592:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.recipeScale=t.calculateScale=void 0;const r=n(367),a=n(444);t.calculateScale=function(e){return e.value&&e.calculated_value?(0,r.isRangeIngredient)(e)?e.calculated_value[0]/e.value[0]:e.calculated_value/e.value:null},t.recipeScale=function(e,t){for(const n of e.ingredient_groups)for(const e of n.ingredients)e.value&&((0,r.isRangeIngredient)(e)?e.calculated_value=[...e.value].map((e=>(0,a.round)(e*t))):e.calculated_value=(0,a.round)(e.value*t));return e}},367:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isRangeIngredient=void 0,t.isRangeIngredient=function(e){return Array.isArray(e.value)}},232:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UNITS=t.NO_VALUE_UNITS=t.VALUE_UNITS=t.MEASURE_UNITS=t.WEIGHT_UNITS=t.VOLUME_UNITS=void 0,t.VOLUME_UNITS=["l","ml"],t.WEIGHT_UNITS=["kg","g"],t.MEASURE_UNITS=["tsp","tbsp","cup","pinch","pcs"],t.VALUE_UNITS=[...t.VOLUME_UNITS,...t.WEIGHT_UNITS,...t.MEASURE_UNITS],t.NO_VALUE_UNITS=["taste"],t.UNITS=[...t.VALUE_UNITS,...t.NO_VALUE_UNITS]},303:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUnitDisplay=t.UNIT_TRANSLATIONS=t.LANG_LIST=void 0,t.LANG_LIST=["ru","en"],t.UNIT_TRANSLATIONS={en:{l:"l",ml:"ml",kg:"kg",g:"g",tsp:"tsp",tbsp:"tbsp",cup:"cup",pinch:"pinch",pcs:"pcs",taste:"taste"},ru:{l:"л",ml:"мл",kg:"кг",g:"г",tsp:"ч.л.",tbsp:"ст.л.",cup:"стакан",pinch:"щепотка",pcs:"штук",taste:"по вкусу"}},t.getUnitDisplay=function(e,n,r=void 0){return t.UNIT_TRANSLATIONS[n][e]}},660:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DEFINED_INGREDIENT_TYPES=void 0,t.DEFINED_INGREDIENT_TYPES=[{name:"sugar",density:900,regexp:[/сахар/gm,/sugar/]},{name:"kosher salt",density:1030,regexp:[/сол[ьи]/gm,/поварен(?:ой|ая) сол[ьи]/gm,/kosher salt/gm]},{name:"table salt",density:1300,regexp:[/мелк(?:ой|ая) сол[ьи]/gm,/table salt/gm]},{name:"vinegar acid",concentration:70,regexp:[/уксусная (?:кислота|эссенция)/gm,/vinegar (?:acid|essence)/gm]},{name:"vinegar",concentration:9,regexp:[/уксусa?/m,/vinegar/m]}]},16:function(e,t,n){var r=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};Object.defineProperty(t,"__esModule",{value:!0}),t.parseIngredientType=t.extractVinegarConcentration=void 0;const a=n(660),o=n(484);function s(e){const t=/(\d+)\s*%/.exec(e);return t?Number.parseInt(t[1]):null}t.extractVinegarConcentration=s,t.parseIngredientType=function(e){for(const t of function(){const e=[];for(const t of a.DEFINED_INGREDIENT_TYPES)e.push(Object.assign(Object.assign({},t),{regexp:(0,o.groupRegExp)(t.regexp,{flags:"mu"})}));return e}())if(t.regexp.test(e)){const{regexp:n}=t,a=r(t,["regexp"]);return t.name.startsWith("vinegar")&&(a.concentration=s(e)||a.concentration),a}return null}},75:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseRecipeLine=void 0;const r=n(232),a=n(300),o=n(356),s=n(444),i=n(484),c=n(16);function u(e,t){return RegExp(`(?<${e}>${t.join("|")})\\.?`)}const l=(0,i.mRegExp)(["(?:",o.VULGAR_LETTER_REGEXP,"|",/(?:\d+[,.]\d+|\d+)/u,")"],"u"),p=RegExp(/(?<value_range>\s*\p{Pd}\s*)/u),d=(0,i.mRegExp)(["(?<value>",l,p,l,"|",l,")"],"u"),g=(0,i.mRegExp)(["(?:",d,/\s?/,"(?<unit>",...r.VALUE_UNITS.map((e=>u(e,a.UNIT_MAP[e]).source)).join("|"),")","|","(?<no_value_unit>",...r.NO_VALUE_UNITS.map((e=>u(e,a.UNIT_MAP[e]).source)).join("|"),")",")\\.?",/(?=\s+|[.,);/]|$)/],"u");t.parseRecipeLine=function(e){var t;let n,a;for(const r of[g,d])if(n=(null===(t=r.exec(e))||void 0===t?void 0:t.groups)||{},(null==n?void 0:n.value)||(null==n?void 0:n.no_value_unit)){a=(0,s.stripLine)(e.replace(r,""));break}if(!n)return null;if(!n.value&&!n.value_range&&!n.no_value_unit)return null;const i={name:a};if(n.value){let e;if(n.value_range){e=[];for(const t of n.value.split(p)){const n=(0,o.parseNumber)(t);n&&e.push(n)}}else e=(0,o.parseNumber)(n.value);i.value=e}for(const e of r.UNITS)n[e]&&(i.unit=e);i.unit||(i.unit="pcs");const u=(0,c.parseIngredientType)(i.name);return u&&(i.type=u),i}},712:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseTextRecipe=void 0;const r=n(75),a=n(444),o=n(16),s="o(. _ .)o";t.parseTextRecipe=function(e){const t={name:"",ingredient_groups:[]};let n={name:"",ingredients:[]},i=0;const c=e.trim().split("\n");c.push(s);for(const e of c){if(!e.trim())continue;const c=(0,r.parseRecipeLine)(e);if(c)1==i&&!c.name&&t.name&&(n.name=t.name,t.name=""),n.ingredients.push(c);else{const r=(0,a.stripLine)(e);if(0==i)t.name=r;else{if(n.ingredients.length>0){if(1==n.ingredients.length&&n.name&&!n.ingredients[0].name){const e=t.ingredient_groups.length>0?t.ingredient_groups.pop():{name:"",ingredients:[]},r=Object.assign(Object.assign({},n.ingredients[0]),{name:n.name}),a=(0,o.parseIngredientType)(n.name);a&&(r.type=a),e.ingredients.push(r),n=e}t.ingredient_groups.push(n)}if(r===s)break;n={name:r,ingredients:[]}}}i++}return t}},300:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UNIT_MAP=void 0,t.UNIT_MAP={pcs:["шт","pcs","ps","зубчик(?:а|ов)?","штук(?:а|и)?"],l:["л","литр","litre","l"],ml:["мл","миллилитр","ml","millilitre"],kg:["кг","килограмм","kg","kilogram"],g:["г","гр","грамм","g","gram"],tsp:["(?:ч\\.|чайн(?:ая|ые))\\s*?(?:л\\.|ложк[аи])","tea\\s*spoons?","tsp"],tbsp:["(?:ст?\\.|столов(?:ая|ые))\\s*?(?:л\\.?|ложк[аи])","table\\s*spoons?","tbsp"],cup:["стакан(?:а|ов)?","ст","cup"],pinch:["щепотка","pinch"],taste:["по вкусу","to taste"]}},444:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.stripLine=t.values=t.entries=t.keys=t.round=void 0,t.round=function(e,t=2){const n=Math.pow(10,t);return Math.round(e*n)/n},t.keys=Object.keys,t.entries=Object.entries,t.values=Object.values,t.stripLine=function(e){return(e=(e=e.trim()).replace(/^(?:[^\p{L}\p{N}()%]+)?(.+?)(?:[^\p{L}\p{N}()%]+)?$/gmu,"$1")).replace(/\p{Zs}+/gmu," ")}},356:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseNumber=t.VULGAR_LETTER_REGEXP=void 0;const r=n(372),a=n(444);t.VULGAR_LETTER_REGEXP=/(?:\p{No}|\d+\s*\/\s*\d+)/u,t.parseNumber=function(e){t.VULGAR_LETTER_REGEXP.test(e)&&(e=(0,a.stripLine)(e).replace(/\p{Zs}/gu,""),e=(0,r.parseVulgars)(e),e=(0,r.toDecimal)(e));const n=parseFloat(e.replace(",","."));return isNaN(n)?null:(0,a.round)(n,2)}},484:(e,t)=>{function n(e){return"[object RegExp]"===toString.call(e)}function r(e,t){return RegExp(a(e),t)}function a(e,t=""){return e.map((function(e){return n(e)?e.source:e})).join(t||"")}Object.defineProperty(t,"__esModule",{value:!0}),t.joinRegExp=t.groupRegExp=t.mRegExp=void 0,t.default=n,t.mRegExp=r,t.groupRegExp=function(e,t={flags:"gum"}){const{flags:n,name:o}=t;return r([o?`(?<${o}`:"(?:",a(e,"|"),")"],n)},t.joinRegExp=a},372:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseVulgars=t.toDecimal=t.toVulgar=void 0;const n={"¼":.25,"½":.5,"¾":.75,"⅐":1/7,"⅑":1/9,"⅒":.1,"⅓":1/3,"⅔":2/3,"⅕":.2,"⅖":.4,"⅗":.6,"⅘":.8,"⅙":1/6,"⅚":5/6,"⅛":.125,"⅜":.375,"⅝":.625,"⅞":.875},r=Object.fromEntries(Object.entries(n).map((([e,t])=>[t,e]))),a=new RegExp(/^\d+\/\d+/),o=new RegExp(/^\d*\.+\d*$/),s=e=>"string"==typeof e?Object.keys(n).includes(e):"number"==typeof e&&Object.keys(r).includes(String(e));t.toVulgar=e=>s(e)?r[e]:e.toString(),t.toDecimal=e=>s(e)?n[e].toString():e,t.parseVulgars=e=>e.split(" ").map((e=>{if(a.test(e)){const[n,r]=e.split("/"),a=parseInt(n,10)/parseInt(r,10);return s(a)?(0,t.toVulgar)(a):e}if(o.test(e)){const[n,r]=e.split("."),a=parseFloat(`.${r}`),o=(0,t.toVulgar)(a);return parseInt(n,10)?`${n} ${o}`:o}return e})).join(" ")}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}(()=>{const e=n(236),t=n(712),r=n(592),a=n(303);function o(e,t){localStorage.getItem(t)&&(e.value=localStorage.getItem(t)),e.addEventListener("change",(()=>{localStorage.setItem(t,e.value)}))}const s="raw_recipe",i="scale",c="new_scale";(0,e.ready)((()=>{const e=document.getElementById("raw_recipe"),n=document.getElementById("parsed_recipe"),u=document.getElementById("scale_wrap"),l=document.getElementById("scale"),p=document.getElementById("new_scale");o(l,i),o(p,c);const d=Object.fromEntries(new URL(window.location.toString()).searchParams.entries());d[i]&&(l.value=d[i]),d[c]&&(p.value=d[c]);const g=()=>{const t=new URL(window.location.toString());t.searchParams.set(i,l.value),t.searchParams.set(c,p.value),t.searchParams.set(s,function(e){const t=String.fromCodePoint(...(new TextEncoder).encode(e));return btoa(t)}(e.value)),window.history.replaceState("","",t.toString())};l.addEventListener("change",g),p.addEventListener("change",g),e.addEventListener("change",g);const v=()=>{const e=Number.parseInt(p.value)/Number.parseInt(l.value);_&&(_=(0,r.recipeScale)(_,e),n.innerHTML=function(e){var t;let n="";e.name&&(n+=`<h2>${e.name}</h2>`),n+='<table>\n  <colgroup>\n  <col span="3" style="width: auto">\n  <col span="3" style="width: 100px">\n  <col span="3" style="width: 100px">\n  </colgroup>\n  <thead>\n  <tr>\n  <th></th>\n  <th>Оригинал</th>\n  <th>Пересчет</th>\n  <th>Единица измерения</th>\n  </tr>\n</thead>\n';for(const r of e.ingredient_groups){r.name&&(n+=`<tr><th colspan='2'>${r.name}</th></tr>`);for(const e of r.ingredients){let r="";e.value&&(r=e.value.toString(),Array.isArray(e.value)&&(r=e.value.join(" - ")));let o="";e.calculated_value&&(o=e.calculated_value.toString(),Array.isArray(e.calculated_value)&&(o=e.calculated_value.join(" - ")));let s="";(null===(t=e.type)||void 0===t?void 0:t.concentration)&&(s=`[${e.type.concentration}%]`),n+=`<tr><td>${e.name} ${s}</td> \n      <td>${r}</td>\n      <td>${o}</td>\n      <td> ${(0,a.getUnitDisplay)(e.unit,"ru",e.value)}</td>\n      </tr>`}}return n+="</table>",n}(_))},m=()=>{const n=e.value;n&&(localStorage.setItem(s,n),_=(0,t.parseTextRecipe)(n),console.log(_),v(),u.style.display="block")};let _;l.addEventListener("change",v),p.addEventListener("change",v),d[s]?e.value=function(e){const t=atob(e);return(new TextDecoder).decode(Uint8Array.from(t,(e=>e.codePointAt(0))))}(d[s]):localStorage.getItem(s)?e.value=localStorage.getItem(s):e.value="\nТрадиционный кимчи  \nКимчи выход 3,6 кг\nКапуста пекинская 2,7 кг\nЗагуститель  \nВода 2 cup\nРисовая мука 2 ст.л.\nСахар 2 ст.л.\nСоус  \nЧеснок 0,5 cup\nИмбирь 2 ч.л.\nЛук репчатый 1 шт\nРыбный соус 0,5 cup\nПерец кочукари 2 cup\nКреветки ферментированые (saeujeot) 0,25 cup\nЯблоки (опционально) 1 шт\nОвощи  \nМорковь 1 cup\nРедис  2 cup\nЗеленый лук 8 шт\n",m(),e.addEventListener("change",m)}))})()})();